<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Uçak Yükleme Hesaplama</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 10px; background:#000; color:#fff; }
    h2 { text-align:center; margin-bottom:15px; }
    .options-box { border: 2px solid #555; border-radius: 10px; padding: 10px; background: #111; max-width: 380px; margin: 0 auto 20px auto; }
    .options-box label { display: block; margin-top: 8px; font-weight: bold; }
    .fuel-block { margin-top: 10px; }
    .fuel-result { font-weight: bold; color: #00ccff; margin-top: 5px; }
    table { border-collapse: collapse; width: 100%; margin-top: 15px; display:none; font-size:14px; }
    th, td { border: 1px solid #555; padding: 5px; text-align: center; }
    th { background: #222; }
    .num { text-align: right; }
    .total { font-weight: bold; background: #111; }
    input[type=number] { width:55px; padding:3px; font-size:14px; background:#222; color:#fff; border:1px solid #444; border-radius:4px; }
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    input[type=number] { -moz-appearance: textfield; }
    /* Fosforlu yeşil */
    .totalCell { color:#00ff66; font-weight:bold; }
    .total td:last-child { color:#00ff66; font-weight:bold; }
  </style>
</head>
<body>
  <h2>Uçak Yükleme Hesaplama</h2>

  <!-- Seçenekler Kutusu -->
  <div class="options-box">
    <label>Uçak Tipi:
      <select id="aircraft">
        <option value="">Seçiniz</option>
        <option value="B737">Boeing 737</option>
        <option value="A319">Airbus A319</option>
        <option value="A320">Airbus A320</option>
        <option value="A321">Airbus A321</option>
        <option value="A330">Airbus A330</option>
        <option value="A350">Airbus A350</option>
        <option value="B777">Boeing 777</option>
        <option value="B787">Boeing 787</option>
        <option value="A319B">Airbus A319 Bulk</option>
        <option value="A320B">Airbus A320 Bulk</option>
        <option value="A321B">Airbus A321 Bulk</option>
      </select>
    </label>

    <label>Ortalama Bagaj Kg:
      <input type="number" id="avgBag" value="20">
    </label>

    <div class="fuel-block">
      <label>Total Fuel (kg): <input type="number" id="totalFuel"></label>
      <label>Taxi Fuel (kg): <input type="number" id="taxiFuel"></label>
      <div class="fuel-result" id="remainFuel"></div>
    </div>
  </div>

  <!-- Hesaplama Tablosu -->
  <table id="table">
    <thead>
      <tr>
        <th>Kompartman</th>
        <th>Bagaj Sayısı</th>
        <th>Bagaj Kg</th>
        <th>Kargo Kg</th>
        <th>Toplam Kg</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const aircraftComps = {
      "B737": ["1","2","3","4"],
      "A319": ["11","12","41","42","51"],
      "A320": ["11","12","13","31","32","41","42","5"],
      "A321": ["11","12","21","22","23","31","32","33","41","42","5"],
      "A330": ["1","2","3","4","5"],
      "A350": ["1","2","3","4","5"],
      "B777": ["1","2","3","4","5"],
      "B787": ["1","2","3","4","5"],
      "A319B": ["1","4","5"],
      "A320B": ["1","3","4","5"],
      "A321B": ["1","2","3","4","5"]
    };

    let compartments = [];
    const table = document.getElementById("table");
    const tbody = table.querySelector("tbody");

    document.getElementById("aircraft").addEventListener("change", () => {
      const val = document.getElementById("aircraft").value;
      tbody.innerHTML="";
      compartments = [];
      if(val){
        table.style.display="table";
        aircraftComps[val].forEach(name=>{
          compartments.push({name, bags:null, cargo:null});
        });
        buildTable();
        updateValues();
      } else {
        table.style.display="none";
      }
    });

    document.getElementById("avgBag").addEventListener("input", updateValues);
    document.getElementById("totalFuel").addEventListener("input", calcFuel);
    document.getElementById("taxiFuel").addEventListener("input", calcFuel);

    function calcFuel(){
      let total = document.getElementById("totalFuel").value;
      let taxi = document.getElementById("taxiFuel").value;
      if(total==="" && taxi===""){
        document.getElementById("remainFuel").textContent = "";
      } else {
        let remain = (parseFloat(total||0) - parseFloat(taxi||0));
        document.getElementById("remainFuel").textContent = "Remaining Fuel: " + remain + " kg";
      }
    }

    function buildTable(){
      tbody.innerHTML="";
      compartments.forEach(c=>{
        const row=document.createElement("tr");
        row.innerHTML=`
          <td>${c.name}</td>
          <td><input type="number" data-comp="${c.name}" class="bagInput"></td>
          <td class="num bagKgCell"></td>
          <td><input type="number" data-comp="${c.name}" class="cargoInput"></td>
          <td class="num totalCell"></td>`;
        tbody.appendChild(row);
      });

      tbody.querySelectorAll(".bagInput").forEach(inp=>{
        inp.addEventListener("input",e=>{
          let comp=compartments.find(x=>x.name===inp.dataset.comp);
          comp.bags = e.target.value==="" ? null : parseFloat(e.target.value);
          updateValues();
        });
      });
      tbody.querySelectorAll(".cargoInput").forEach(inp=>{
        inp.addEventListener("input",e=>{
          let comp=compartments.find(x=>x.name===inp.dataset.comp);
          comp.cargo = e.target.value==="" ? null : parseFloat(e.target.value);
          updateValues();
        });
      });
    }

    function updateValues(){
      const avg=+document.getElementById("avgBag").value||0;
      const rows=tbody.querySelectorAll("tr");
      compartments.forEach((c,i)=>{
        const bagKg=(c.bags||0)*avg;
        const total=bagKg+(c.cargo||0);
        rows[i].querySelector(".bagKgCell").textContent=bagKg?bagKg.toFixed(1):"";
        rows[i].querySelector(".totalCell").textContent=total?total.toFixed(1):"";
      });

      // eski grup satırlarını temizle
      tbody.querySelectorAll(".total").forEach(r=>r.remove());
      const val=document.getElementById("aircraft").value;
      if(val==="A319"){
        addGroupRow(["11","12"],"11+12 Toplam");
        addGroupRow(["41","42"],"41+42 Toplam");
        addGroupRow(["51"],"51 Toplam");
      }
      if(val==="A320"){
        addGroupRow(["11","12","13"],"11+12+13 Toplam");
        addGroupRow(["31","32"],"31+32 Toplam");
        addGroupRow(["41","42"],"41+42 Toplam");
        addGroupRow(["5"],"5 Toplam");
      }
      if(val==="A321"){
        addGroupRow(["11","12"],"11+12 Toplam");
        addGroupRow(["21","22","23"],"21+22+23 Toplam");
        addGroupRow(["31","32","33"],"31+32+33 Toplam");
        addGroupRow(["41","42"],"41+42 Toplam");
        addGroupRow(["5"],"5 Toplam");
      }
    }

    function addGroupRow(names,label){
      const avg=+document.getElementById("avgBag").value||0;
      let bagSum=0,cargoSum=0;
      names.forEach(n=>{
        let c=compartments.find(x=>x.name===n);
        if(c){ bagSum+=(c.bags||0)*avg; cargoSum+=(c.cargo||0); }
      });
      const row=document.createElement("tr");
      row.className="total";
      row.innerHTML=`<td>${label}</td><td colspan="3"></td><td class="num">${(bagSum+cargoSum).toFixed(1)}</td>`;
      tbody.appendChild(row);
    }
  </script>
</body>
</html>
